# SPWM单相逆变电源的电路分析

> **文档摘要**：本文档采用电路基本原理对单相逆变电源的电路进行理论分析、计算，并采用Multisim仿真软件进行电路仿真，与理论计算结果进行对比，除此之后，还使用WCCA(最坏情况分析)方法分析电路的可靠性； 

---

## 1. 变压器输出电压检测电路

### 1.1 原理图

![原理图](I:\work\git\spwm\docs\images\u1.jpg)

### 1.2 主要元器件及其参数

**1）TV1 高频脉冲电压互感器小型铁氧体**

| 名称   | 规格        | **单位** |
|:----:|:---------:| ------ |
| 额定输入 | 2         | mA     |
| 额定输出 | 2         | mA     |
| 电流变比 | 1000:1000 |        |

**2) U9 LM258运算放大器**

**3) D7**

### 1.3 电路分析

**1）等效电路**

![u3.jpg](I:\work\git\spwm\docs\images\u3.jpg)

假设输入电压为$u(t)=Asin(2\pi ft)$其中f为变压器输出电压的频率，f=50Hz；

A为变压器输出电压的幅度； 

根据电压互感器的规格，互感器初级电流为$i_1=\frac{Asin(2\pi ft)}{(R_{19}+R_{25})}$

由于互感器的电流变比为1:1，所以互感器的次极电流为$i_2=i_1$，

当SPWM的调制度为100%时，变压器输出电压的真有效值为130V，次级电流$i2=\frac{110sin(2\pi ft)}{30k\Omega+30k\Omega}=2.16sin(2\pi ft)mA$：

该电路连接了两个电源，一个是直流电压源，经过分压之后输入到运放的同相输入端，

另一个是变压器的输出电压，经过电压互感器耦合得到电流信号，作为交流电流源，经过分流之后输入到运放的反相输入端，

通过叠加原理分析这两个电源在运放输出端的输出电压；

**2）直流通路**

交流电流源$i2$视为断路，在节点4，电容$C_{25}$对于直流信号的阻抗非常大，可视为断路，

而因为运放的"虚断"的特性，流入同相输入端的电流为0，因此，流入节点4的电流有以下两条路径：

由$V_{CC}$经过$R_{24}$流入节点4，电流大小为：

$\frac{V_{CC}-V_{+}}{R_{24}}$

由GND经过$R_{26}$流入节点4，电流大小为：

$\frac{0-V_{+}}{R_{26}}$

流入节点4的总电流为0，因此有：
$V_{+}=V_{CC}\times\frac{R_{26}}{R_{24}+R_{26}}$

因为运放“虚短”的特性，其反相端电压等于同相端的电压，

$V_{-}=V_{+}$

i2视为断路，电容$C_{22}$以及$C_{21}$对于直流信号也视为断路，

因此，流入节点1的总电流为：

$\frac{0-V_1}{R_{23}}+\frac{V_2-V_1}{R_{21}}=0$

而流入节点2的总电流为：

$\frac{0-V_{-}}{R_{23}+R_{21}}+\frac{V_O-V_-}{R_{20}}=0$

得到：

$V_O=(1+\frac{R_{20}}{R_{23}+R_{21}})\times V_-=(1+\frac{R_{20}}{R_{23}+R_{21}})\times V_+$

根据电路的器件具体参数，得到，运放的直流输出电压为：

$V_O=(1+\frac{10}{5.1+0.2}) \times \frac{3.3 \times 2}{2+10}=1.59V$

**3）交流通路**

直流电压源$V_{CC}$视为短路到0，${V_{CC}=0}$，运放的反相输入端电压$V_-=V_+=0$

如果交流信号的频率比较低，电容$C_{22}$以及$C_{21}$对于该交流信号也视为断路，

流入节点1的总电流为：

$i2+\frac{0-V_1}{R_{23}}+\frac{0-V_1}{R_{21}}=0$

流入节点2的总电流为：

$\frac{V_1-0}{R_{21}}+\frac{V_O-0}{R_{20}}=0$

得到$V_O=-i_2\times\frac{R_{20}\times R_{23}}{R_{21}+R_{23}}$

$V_O=-2.17sin(2\pi ft) \times(\frac{10k\times 200 \Omega }{200\Omega+5.1k})=819sin(2\pi ft)mV$

输出交流电压的峰峰值为$819\times 2\times\sqrt2=2.316V$

输入到MCU ADC口的电压范围在$1.59-\frac{2.316}{2}$与$1.59+\frac{2.316}{2}$之间，即0.432V-2.748V之间；

根据上述分析，也可以如下将电压互感器的次极输出电路通过戴维南定理等效为：

![戴维南等效](I:\work\git\spwm\docs\images\u4.jpg)

**4）滤波电路**

### 1.4 Multisim仿真

### 1.5 WCCA分析
